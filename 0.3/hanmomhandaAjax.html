<!DOCTYPE html>
<html lang='ko'>
<head>
<meta charset='utf-8'> 
</head>
<body>
<form method='post' action='http://hanmomhanda-apex-mint/bsCORS/mockTarget.php'>
<input type='text' id='keyword1'>
<br/>
<input type='text' id='keyword2'>
</form>
<script src="http://projectbs.github.io/bsJS/bsjs.0.3.js"></script>
<script>
bs( function(){

bs.Dom( '<div></div>' ).S( 
    '<', 'body', // body를 부모로
    'html', 'bsCORS', // html 입력
    'width', 300, // 스타일 지정
    'click', bsCORS // 이벤트 등록
);
    
bs.Dom( '<div></div>' ).S( 
    '<', 'body', // body를 부모로
    'html', 'directCORS', // html 입력
    'width', 300, // 스타일 지정
    'click', directCORS // 이벤트 등록
);
function end(data) {
    console.log(data);
}

function bsCORS() {
//    console.log(document.forms[0].elements[0].value);
//    console.log(document.forms[0].action);

//    bs.post(end, 'http://hanmomhanda-apex-mint/bsCORS/bsCORS.php', 
//            'url', document.forms[0].action, 
//            'p1', document.forms[0].elements[0].value,
//            'p2', document.forms[0].elements[1].value);
    var xhr = getXHR();
    xhr.onreadystatechanged = handleStateChange;
    xhr.open("POST", 'http://hanmomhanda-apex-mint/bsCORS/bsCORS.php', true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=UTF-8");
    xhr.send('p1=' + document.forms[0].elements[0].value + '&p2=' + document.forms[0].elements[1].value);
}

function directCORS() {
    var xhr = getXHR();
    xhr.onreadystatechanged = handleStateChange;
    xhr.open("POST", document.forms[0].action, true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=UTF-8");
    xhr.send('p1=' + document.forms[0].elements[0].value + '&p2=' + document.forms[0].elements[1].value);

}

function handleStateChange() {
    if (xhr.readtState == 4 ) {
        if (xhr.status == 200 ) {
            console.log(xhr.responseText);
        }
    }
}

function getXHR() {
    var xhr;
    if (window.ActiveXObject) {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
    } else if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
    }
    return xhr;
}

} );
</script>
</body>
</html>
